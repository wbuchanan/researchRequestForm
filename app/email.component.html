<form [formGroup]="email" novalidate>
  <div class="form-group">
    <!--addresses-->
    <div formArrayName="emailAddresses">
      <div *ngFor="let address of email.controls.emailAddresses.controls; let i=index" class="panel panel-default">
        <div class="panel-heading">
          <span>Email Address {{i + 1}}</span>
          <span class="glyphicon glyphicon-remove pull-right" *ngIf="email.controls.emailAddresses.controls.length > 1" (click)="removeEmailFields(i)"></span>
        </div>
        <div class="panel-body" [formGroupName]="i">
          <div class="form-group col-xs-4">
            <label for="emailType">Email Type:</label>
            <select class="form-control" id="emailType" formControlName="emailType" [(ngModel)]="emails[i].emailType">
              <option *ngFor="let m of emailTypes" [value]="m">{{m}}</option>
            </select>
          </div>
          <div class="form-group col-xs-4">
            <label for="userName">User Name:</label>
            <input type="text" class="form-control" id="userName" formControlName="userName" [(ngModel)]="emails[i].userName">
            <div *ngIf="!email.controls.emailAddresses.controls[i].controls.userName.valid && !email.controls.emailAddresses.controls[i].controls.userName.pristine" class="alert alert-danger" style="font-size: 12px">
              Invalid User Name
            </div>
          </div>
          <div class="form-group col-xs-1">
            <span><strong>@</strong></span>
          </div>
          <div class="form-group col-xs-3">
            <label for="domain">Domain:</label>
            <input type="text" class="form-control" id="domain" formControlName="domain" [(ngModel)]="emails[i].domain">
            <div *ngIf="!email.controls.emailAddresses.controls[i].controls.domain.valid && !email.controls.emailAddresses.controls[i].controls.domain.pristine" class="alert alert-danger" style="font-size: 12px">
              Invalid domain must be one of .com, .net, .gov, .us, .edu, or .org
            </div>
          </div>
          <div class="col-xs-12">
            <a (click)="addEmailFields()" style="cursor: default">
              Add another email address +
            </a>
          </div>
        </div>
      </div>
    </div>
  </div>
</form>
